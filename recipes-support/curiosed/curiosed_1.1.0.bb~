DESCRIPTION = "Flight Software for CuRIOS-ED"
HOMEPAGE = ""
LICENSE = "CLOSED"

DEPENDS = "zlib bzip2 curl openssl libusb cfitsio monit nano"

# Overrides
SOLIBS = ".so"
FILES_SOLIBSDEV = ""

inherit autotools-brokensep pkgconfig

#PR = "r1"
LIC_FILES_CHKSUM = ""
#LIC_FILES_CHKSUM = "file://licenses/License.txt;md5=77856e8a5492e2119200b3401a8e7966"

SRC_URI = "file:///home/curios/curios_fsw/*"

S = "${WORKDIR}/home/curios/curios_fsw"

inherit cmake

do_install:append () {
    install -d ${D}${bindir}
    install -d ${D}${libdir}
    install -d ${D}/opt
    install -d ${D}/data
    install -d ${D}/home/root
    install -d $[D}/etc/systemd/network
    install -d ${D}/etc/flightsim
#    install -d ${D}/etc/dropbear

    install -m 0755 ${WORKDIR}/home/curios/curios_fsw/lib/libatikcameras.so ${D}${libdir}
    install -m 0755 ${WORKDIR}/home/curios/curios_fsw/lib/libflightapi.a ${D}${libdir}

    # Move over rootfs files
    install -m 0755 ${WORKDIR}/home/curios/curios_fsw/files/q7s/home/root/.profile ${D}/home/root/
 #  install -m 0600 ${WORKDIR}/home/curios/curios_fsw/files/q7s/etc/dropbear/dropbear_rsa_host_key ${D}/etc/dropbear/
    install -m 0755 ${WORKDIR}/home/curios/curios_fsw/files/q7s/etc/systemd/network/05-eth0.network ${D}/etc/systemd/network/

    # Install StarSpec flightsim files
    cp -r ${WORKDIR}/home/curios/curios_fsw/files/q7s/etc/flightsim/* ${D}/etc/flightsim/
    
}

FILES:${PN} += " \
  /opt \
  /data \
  ${bindir}/* \
  ${libdir}/* \
  /home/root/* \
  /etc/flightsim/* \
  /etc/systemd/network/* \
"

#
#  /etc/dropbear/* \
#
